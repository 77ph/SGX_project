# TODO: Security Improvements

## Криптографические улучшения
- [x] Реализовать безопасное удаление чувствительных данных (использовать `sgx_secure_memset` вместо обычного `memset`)
- [x] Удалить неиспользуемый функционал nonce (мы работаем по модели Ledger, где nonce не нужен)

## Управление ключами
- [ ] Добавить возможность резервного копирования ключей с шифрованием
- [ ] Реализовать механизм восстановления ключей
- [ ] Добавить проверку целостности ключей при каждой операции

## Безопасность энклава
- [ ] Добавить проверку версии энклава при загрузке
- [ ] Реализовать механизм обновления энклава
- [ ] Добавить защиту от rollback-атак при сохранении состояния
- [ ] Реализовать механизм обнаружения компрометации энклава

## Аудит и логирование
- [ ] Добавить безопасное логирование критических операций
- [ ] Реализовать механизм аудита доступа к ключам
- [ ] Добавить мониторинг подозрительной активности
- [ ] Реализовать механизм оповещения о подозрительных операциях

## Управление состоянием
- [ ] Реализовать пул аккаунтов в памяти:
  - [ ] Создать фиксированный пул слотов для аккаунтов (например, 10 слотов)
  - [ ] Добавить команды для загрузки аккаунтов в конкретные слоты
  - [ ] Модифицировать команду sign_tx для работы с аккаунтами по их адресу в пуле
  - [ ] Добавить команды для просмотра состояния пула (занятые/свободные слоты)
  - [ ] Реализовать механизм выгрузки аккаунтов из пула
  - [ ] Добавить проверки безопасности при работе с пулом

## Восстановление после сбоя железа
- [ ] Реализовать опциональное резервное копирование при генерации аккаунта:
  - [ ] Добавить параметр для публичного RSA ключа пользователя при генерации
  - [ ] Создать дополнительный файл с зашифрованными данными аккаунта (RSA)
  - [ ] Сохранять оригинальный файл с SGX шифрованием
  - [ ] Добавить команду для проверки наличия резервной копии
  - [ ] Реализовать механизм восстановления из резервной копии на новом железе
- [ ] Добавить документацию по процессу восстановления
- [ ] Реализовать проверку целостности резервных копий
- [ ] Добавить механизм удаления резервных копий

## Валидация входных данных
- [ ] Усилить проверку формата и длины входных данных
- [ ] Добавить проверку на переполнение буфера
- [ ] Реализовать санитизацию всех входных параметров
- [ ] Добавить проверку на инъекции в параметры команд

## Защита от атак
- [ ] Добавить защиту от replay-атак
- [ ] Реализовать механизм защиты от атак типа "man-in-the-middle"
- [ ] Добавить проверку на атаки типа "birthday attack"
- [ ] Реализовать механизм защиты от атак типа "dictionary attack"

## Управление доступом
- [ ] Реализовать механизм разграничения доступа к разным операциям
- [ ] Добавить поддержку ролей и разрешений
- [ ] Реализовать механизм делегирования доступа
- [ ] Добавить проверку прав доступа для каждой операции

## Резервное копирование
- [ ] Реализовать безопасное резервное копирование состояния
- [ ] Добавить механизм восстановления из резервной копии
- [ ] Реализовать проверку целостности резервных копий
- [ ] Добавить механизм ротации резервных копий

## Документация и тестирование
- [ ] Добавить документацию по безопасности
- [ ] Реализовать автоматические тесты безопасности
- [ ] Добавить проверку на уязвимости
- [ ] Реализовать механизм отчетности о проблемах безопасности 